\documentclass[nochap,palatino]{apuntes}

\usepackage{sagetex}

\begin{document}

\section{Análisis sistemático de una función}

\begin{problem}
Analiza sistemáticamente la siguiente función:

\input{function}

\[f(x) = \sagestr{latex(f(x))}\]

\solution


\subsection{Asíntotas}
\subsubsection{Asíntotas verticales}

\begin{sagesilent}
den=f.denominator(normalize=False)
den0=solve(f.denominator(normalize=False) == 0,x,solution_dict=True)
def asintotesV():
    r=""
    k=0

    r+= "Soluciones: "
    for i in den0:
        r+="$x_"+str(k)+"="+str(i[x])+" $;\\quad"
        k+=1

    for x0 in den0:
        r+= "\n \\paragraph{Asintota en x ="
        r+= str(x0[x])+"}"
        ld=limit(f,x=x0[x],dir="plus")
        li=limit(f,x=x0[x],dir="minus")
        r+= "\n Calculamos \[\\lim_{x\\mapsto " + str(x0[x]) + "} " + latex(f(x)) + " = \\left\\{\\begin{array}{cc}\\text{Por la derecha: } & x\\mapsto" + latex(ld) + " \\\\ \\text{Por la izquierda: } & x\\mapsto" + latex(li) + "\\end{array}\\right.\] "
        if (abs(li) == Infinity and abs(ld) == Infinity):
            r+= "\n\t     La recta x =" + str(x0[x]) + " es una \\textbf{asíntota vertical} de f(x)"
        else:
            r+= "\n \\textbf{No hay asíntota vertical} en x="+str(x0[x])+"."
    return r
\end{sagesilent}

Los posibles puntos de asíntota son los que anulan el denominador, para ello calculamos:
$ \sagestr{latex(den)} = 0 $.

\sagestr{asintotesV()}

\subsubsection{Asíntotas horizontales u oblícuas}

Para ello calculamos el límite tanto en $+\infty$ como en $-\infty$:

\[\lim_{x\mapsto \pm\infty} \sagestr{latex(f(x))} \]

\begin{sagesilent}
def asintotesHO():
    r=""
    for infty in [Infinity, -Infinity]:
        r+= "\\paragraph{En $"+latex(infty)+"$:}"
        ld=limit(f, x=infty)  

        r+= "\[\\lim_{x\\mapsto "+latex(infty)+"}" + latex(f(x)) + "="+latex(ld)+"\]"    

        if (not (abs(ld) == Infinity)): # HORIZONTAL
            r+= "En $"+latex(infty)
            r+= "$ f(x) tiene una \\textbf{asíntota horizontal} en y = $"+latex(ld)+"$"

        else: # OBLICUA
            r+= "Podemos tener una asíntota oblícua. Para comprobarlo calculamos: "
            r+= "\[m=\\lim_{x\\mapsto "+latex(infty)+"} \\frac{"+latex(f(x))+"}{x}=\\lim_{x\\mapsto "+latex(infty)+"} "+latex(f(x)/x)+"\]"
            _m=limit(f/x,x=infty)
            m=_m
            if (abs(m) != Infinity):
                r+= "        En este caso+ ese límite tenemos m="+latex(m)+" por lo que sí hay asíntota oblícua. Calculamos n:"
                r+= "    \[n=\\lim_{x\\mapsto "+latex(infty)+"}\\left("+latex(f(x))+"-"+latex(m)+"x \\right) = \\lim_{x\\mapsto "+latex(infty)+"}"+latex(f(x)-m*x)+"\]"
                _n = limit(f-m*x,x=infty)
                n=_n
                y=m*x+n
                r+= "En $"+latex(infty)+"$ f(x) tiene una \\textbf{asíntota oblícua} en y="+latex(y)
            else:
                r+= "En este caso, ese límite tenemos m="+latex(m)+" por lo que \\textbf{no hay asíntota} oblícua (ni horizontal)."

    return r

\end{sagesilent}

\sagestr{asintotesHO()}

\section{Simetría}
\begin{sagesilent}
def simetria():
    if (f(x) == f(-x)):
        return "Sí, a f(x), entonces la función es par"
    elif (f(x) == - f(-x)):
        return "Sí, a -f(x) entonces la función es impar"
    else:
        return "No, entonces la función no tiene simetría respecto del eje Y."
\end{sagesilent}

Calculamos 
\[f(-x) = \sage{latex(f(-x))}\]

¿Es igual a f(x) o a -f(x)?" \sagestr{simetria()}

\section{Puntos de corte con los ejes}
\begin{sagesilent}
def puntosEjeX():
    r=""
    for i in xrange(len(f.roots())):
        r+="$x_"+str(i)+" = "+latex(f.roots()[i][0])+"$;\\quad"
    return r
\end{sagesilent}

\subsection{Eje X}
Resolvemos f(x) = 0 cuya solución es: 
\sagestr{puntosEjeX()}

\subsection{Eje Y}
Resolvemos $f(0)=\sagestr{latex(f(0))}$


\section{Estudio de la monotonía}

\begin{sagesilent}
def derivadaNula():
    i=0
    retval=""
    for r in solve(diff(f(x))==0,x,solution_dict=True):
        retval += "$x_"+str(i)+" = "+latex(r[x])+"$;\\quad"
        i+=1
    return retval

ptscrit = flatten([den0,solve(diff(f(x))==0,x,solution_dict=True)])
recta=[-Infinity]

def ptsCriticos():
    i=0
    r=""
    for p in ptscrit:
        r+= "$x_"+str(i)+"="+latex(p[x])+"$;\\quad"
        i+=1
    return r

[recta.append(p[x]) for p in ptscrit]
recta.append(+Infinity)
recta=sorted(recta)

def intervalos():
    r=""
    for i in xrange(len(recta)-1):
	    r+= "$("+latex(recta[i])+","+latex(recta[i+1])+")$\\n"  
	return r

\end{sagesilent}
Calculamos la derivada de la función:

\[f'(x) = \sagestr{latex(diff(f,x,1)(x))} \]

Para calcular los puntos críticos, resolvemos f'(x) = 0 cuyas soluciones son: 
\sagestr{derivadaNula()}

Por lo tanto, los puntos críticos son (OJO: Se deben incluir los puntos de discontinuidad): 
\sagestr{ptsCriticos()}


Con estos ingredientes ya podemos estudiar la monotonía. Para ello tomamos los siguientes intervalos en los que los puntos críticos dividen la recta real:




   
\begin{sagesilent}



def random_between(j,k):
    
    if (j==-Infinity):
        j2=-9999
    else:
        j2=j+1 # El +1 es para evitar divisiones por 0 que podrían darse.
        
    if (k==Infinity):
        k2=9999
    else:        
        
        k2=k-1 # El +1 es para evitar divisiones por 0 que podrían darse
    return int(random()*(k2-j2+1))+j2
\end{sagesilent}

\end{problem}

\end{document}